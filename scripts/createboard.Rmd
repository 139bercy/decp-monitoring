---
title: "Données essentielles de la commande publique"
author: "MEF/SG"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: scroll
    social: menu
---

```{r setup, include=FALSE}
require(highcharter)
require(flexdashboard)
require(DT)
require(lubridate)
load(file = "output/stats.Rdata")
```

Dashboard
=======================================================================

Row
-----------------------------------------------------------------------

### marchés publiés
```{r}
valueBox(sum(nbmarches$nb), icon = "ion-android-folder-open")
```

### marchés publiés 10 derniers jours
```{r}
valueBox(sum(nbmarches$nb_10J), icon = "ion-ios-clock-outline")
```

### marchés publiés 3 derniers jours
```{r}
valueBox(sum(nbmarches$nb_3J), icon = "ion-android-alarm-clock")
```

### partenaires sans données depuis 10 jours
```{r}
nodata <- sum(nbmarches$nb_10J==0)
valueBox(nodata, icon = "ion-android-alert", 
         color=ifelse(nodata>1, "warning","primary"))
```



Row
-----------------------------------------------------------------------

```{r}
highchart() %>% 
  hc_xAxis(categories = stats2$date) %>% 
  #hc_yAxis(type="logarithmic") %>%
  hc_add_series(name = "Aife", type = "column", data = stats2$aife) %>%
  hc_add_series(name = "DGFiP (PES marchés)", type = "column", data = stats2$pes) %>%
  hc_add_series(name = "e-marchespublics", type = "column", data = stats2$emarchespublics) %>%
  hc_add_series(name = "Grand Lyon", type = "column", data = stats2$grandlyon) %>%
  hc_add_series(name = "MarchésPublics.info", type = "column", data = stats2$marchespublicsinfo)
```


Row
-----------------------------------------------------------------------

```{r}
highchart() %>% 
  hc_xAxis(categories = stats2$date) %>% 
  hc_chart(type="area") %>%
  hc_plotOptions(area = list(stacking="normal")) %>%
  hc_add_series(name = "Aife",  data = stats_cumul$aife) %>%
  hc_add_series(name = "DGFiP (PES marchés)",  data = stats_cumul$pes) %>%
  hc_add_series(name = "e-marchespublics", data = stats_cumul$emarchespublics) %>%
  hc_add_series(name = "Grand Lyon", data = stats_cumul$grandlyon) %>%
  hc_add_series(name = "MarchésPublics.info", data = stats_cumul$marchespublicsinfo)
```


Données
=======================================================================

Tableau de comptage des marchés réceptionnés par jour via les différents canaux

```{r}
datatable(stats2, rownames = FALSE, filter = 'top', options = list(pageLength = 20))
```




Mentions légales
=======================================================================

## Objectifs

Ce tableau de bord permet de superviser le processus de construction consolidée des données essentielles de la commande publique.

## Volet technique
Il est hébergé sur la plateforme GitHub.

Il est administré par l'équipe **Bercy Hub** de la délégation au système d'information des ministères économiques et financiers, en lien avec les équipes DAJ.

## Partenaires
Un grand merci aux équipes Aife, DGFiP et des partenaires qui publient leurs données.


